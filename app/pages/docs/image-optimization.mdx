---
title: El Componente Image y Optimización de Imágenes
sidebar_label: Optimización de Imágenes
---

Blitz viene con un componente `Image` y optimización automática de
imágenes.

El componente `Image` es una extensión del componente `<img>` (de HTML
plano) pensado para la web moderna.

La optimización automática de imágnes te permite redimensionar, comprimir,
y servir imágenes en formatos modernos como
[WebP](https://developer.mozilla.org/en-US/docs/Web/Media/Formats/Image_types)
solo si el navegador lo soporta. Esto evita enviar imágenes gigantes a
dispositivos pequeños. Esto también le permite a Blitz adoptar formatos
futuros automáticamente y servirlos a aquellos navegadores que lo
soporten.

La optimización automática de imágnes aplica a cualquier fuente: no
importa si la imagen está en la carpeta de tu proyecto o viene de una
fuente externa (como un CMS), esta puede ser optimizada.

En vez de optimizar las imágenes en el momento de compilación, Blitz
optimiza las imágenes _a la carta_ y cuando los usuarios las necesiten. A
diferencia de los generadores de sitios estáticos y de las soluciones
meramente estáticas, tus tiempos de compilación son lo mismos si tienes 10
imágenes o si tienes 1,000,000 de imágenes.

Las imágenes son
[_lazy loaded_](https://developer.mozilla.org/en-US/docs/Web/Performance/Lazy_loading)
por defecto. Esto significa que la velocidad de carga de tu página no es
penalizada por imágenes que no se vean al inicio. Las imágenes se cargarán
cuando el usuario baje hasta verlas.

Las imágenes siempre se renderizan de tal forma que se evita el
[_Cumulative Layout Shift_](https://web.dev/cls/), un
[_Core Web Vital_](https://web.dev/vitals/) que Google
[usará en su _search ranking_](https://webmasters.googleblog.com/2020/05/evaluating-page-experience.html).

## El Componente `Image` {#image-component}

Para añadir una imagen a tu aplicación, importa el componente `Image`:

```jsx
import {Image} from "blitz"

function Home() {
  return (
    <>
      <h1>Inicio</h1>
      <Image
        src="/yo.png"
        alt="Foto del autor"
        width={500}
        height={500}
      />
      <p>¡Bienvenidos a mi página!</p>
    </>
  )
}

export default Home
```

## Configuración {#configuration}

Además de las propiedades disponibles para el componente `Image`, puedes
configurar la optimización de imágenes para casos más avanzados desde
`blitz.config.js`.

### Dominios {#domains}

Para habilitar la optimización de imágenes alojadas en un sitio externo,
usa una URL absoluta en el campo `src` del componente `Image` y especifica
qué `domains` deberán ser optimizados. Esto es necesario para evitar el
abuso de URL externas.

```js
module.exports = {
  images: {
    domains: ["example.com"],
  },
}
```

### Cargadores u Optimizadores {#loader}

Si quieres que un _cloud provider_ optimice las imágenes en vez de
utilizar el por defecto de Blitz, puedes configurar qué proveedor y qué
prefijo utilizar. El prefijo te permite usar URL relativas en el `src`.

```js
module.exports = {
  images: {
    loader: "imgix",
    path: "https://example.com/myaccount/",
  },
}
```

Los siguientes _cloud providers_ son soportados:

- [Vercel](https://vercel.com): Funciona automáticamente sin configuración
  extra.
  [Más información](https://vercel.com/docs/next.js/image-optimization)
- [Imgix](https://www.imgix.com): `loader: 'imgix'`
- [Cloudinary](https://cloudinary.com): `loader: 'cloudinary'`
- [Akamai](https://www.akamai.com): `loader: 'akamai'`
- Por defecto: Funciona automáticamente cuando ejecutas `blitz dev`, o
  utilizas un servidor personalizado

## Cacheo {#caching}

A continuación se describe el algorítmo de cacheo para el
[optimizador por defecto](#loader). Para el resto de optimizadores, lee la
documentación de tu _cloud provider_.

Las imágenes son optimizadas dinámicamente en el momento que se solicitan
y se guardan en la carpeta `<distDir>/cache/images`. La imagen optimizada
será servida a las siguientes peticiones hasta que esta expire. Cuando se
pida una imagen cuyo caché haya expirado, este caché será borrado y luego
se generará de nuevo la imagen.

La expiración ("edad máxima" o "_Max-Age_") es definida por el encabezado
`Cache-Control` del servidor de origen.

Si `s-maxage` es encontrado en `Cache-Control`, este será utilizado. De lo
contrario, se utilizará `max-age`. Si ninguno de los dos está definido,
expirará en 60 segundos.

Puedes configurar [`deviceSizes`](#device-sizes) e
[`imageSizes`](#image-sizes) para reducir la cantidad de imágenes
generadas posibles.

## Avanzado {#advanced}

La siguiente configuración es para casos complejos y normalmente no es
necesaria. Si eliges configurar las propiedades descritas a continuación,
anularás cualquier cambio de las opciones por defecto de Blitz en futuras
actualizaciones.

### Tamaños de los Dispositivos {#device-sizes}

En algunos casos, cuando sabes el ancho de los disposivos de los usuarios
que navegan tu sitio, puedes especificar una lista de _breakpoints_ usando
la propiedad `deviceSizes`. Estos anchos son utilizados cuando el
componente `Image` usa `layout="responsive"` o `layout="fill"` para que la
imagen correcta sea entregada al dispositivo visitando tu sitio.

Si ninguna configuración es definida, se utilizarán los siguientes
valores:

```js
module.exports = {
  images: {
    deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840],
  },
}
```

### Tamaños de las Imágenes {#image-sizes}

Puedes especificar una lista de anchos de imágenes utilizando la propiedad
`imageSizes`. Estos anchos suelen ser diferentes (normalmente más
pequeños) que los anchos definidos en `deviceSizes`, ya que estos _arrays_
serán concatenados. Estos anchos son usados cuando el componente `Image`
usa `layout="fixed"` o `layout="intrinsic"`.

Si ninguna configuración es definida, se utilizarán los siguientes
valores:

```js
module.exports = {
  images: {
    imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],
  },
}
```

## `Image` API {#image-api}

La optimización de imágenes puede ser habilitada a través del componente
`Image`.

### Uso {#usage}

Por ejemplo, considera un proyecto con los siguientes archivos.

- `pages/index.js`
- `public/yo.png`

Podemos servir una imagen optimizada de este modo:

```jsx
import {Image} from "blitz"

function Home() {
  return (
    <>
      <h1>Inicio</h1>
      <Image
        src="/yo.png"
        alt="Foto del autor"
        width={500}
        height={500}
      />
      <p>¡Bienvenidos a mi página!</p>
    </>
  )
}

export default Home
```

### Propiedades Necesarias {#required-props}

El componente `Image` necesita las siguientes propiedades.

#### src

La dirección o URL de la imagen. Esta propiedad no es opcional.

Cuando se use una URL externa, debes añadirla a [`domains`](#domains) en
`blitz.config.js`.

#### width

El ancho de la imagen en píxeles. Debe ser un entero sin unidad.

Necesario a no ser que `layout="fill"`.

#### height

La altura de la imagen en píxeles. Debe ser un entero sin unidad.

Necesario a no ser que `layout="fill"`.

### Propiedades Opcionales {#optional-props}

El componente `<Image />` acepta, pero no necesita, las siguientes
propiedades.

#### layout

El disposición (o _layout_) de la imagen cuando el ventana (o _viewport_)
cambia de tamaño. Su valor por defecto es `intrinsic`.

Cuando es `fixed`, las dimensiones de la imagen no cambian aunque el
tamaño de la ventana varíe (no es _responsive_). Esto es similar al
elemento nativo `img`.

Cuando es `intrinsic`, la imagen adaptará sus dimensiones en los tamaños
más pequeños pero mantendrá su dimensiones originales en los tamaños más
grandes.

Cuando es `responsive`, la imagen adaptará sus dimensiones en los tamaños
más pequeños y en los más grandes.

Cuando es `fill`, la imagen se estirará en ambos ejes hasta tener las
mismas dimensiones que su elemento contenedor; usualmente se utiliza junto
a
[object-fit](https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit).

Pruébalo:

- [Demo de `fixed`](https://image-component.nextjs.gallery/layout-fixed)
- [Demo de `intrinsic`](https://image-component.nextjs.gallery/layout-intrinsic)
- [Demo de `responsive`](https://image-component.nextjs.gallery/layout-responsive)
- [Demo de `fill`](https://image-component.nextjs.gallery/layout-fill)
- [Demo de una imagen fondo](https://image-component.nextjs.gallery/background)

### loader {#loader-1}

Una función utilizada para resolver la URL. Por defecto utiliza el objeto
[`images` en `blitz.config.js`](#loader).

`loader` es una función que devuleve una URL en base a los siguientes
parámetros:

- `src`
- `width`
- `quality`

```js
import {Image} from "blitz"

const myLoader = ({src, width, quality}) => {
  return `https://example.com/${src}?w=${width}&q=${quality || 75}`
}

const MyImage = (props) => {
  return (
    <Image
      loader={myLoader}
      src="/me.png"
      alt="Picture of the author"
      width={500}
      height={500}
    />
  )
}
```

#### sizes

Un _string_ que relaciona _media queries_ con tamaños de dispositivos. Por
defecto es `100vw`.

Recomendamos configurar `sizes` cuando `layout="responsive"` y tu imagen
no será del mismo ancho que la ventana.

[Más información](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-sizes).

#### quality

La calidad de la imagen optimizada, un entero entre 1 y 100, donde 100 es
la mejor calidad. Por defecto, 75.

#### priority

Cuando es `true`, la imagen será considerada de alta prioridad y se la
[precargará](https://web.dev/preload-responsive-images/).

Solo debería usarse cuando la imagen es de las primeras en ser vistas. Por
defecto es `false`.

### Propiedades Avanzadas {#advanced-props}

En algunos casos, puedes llegar a necesitar un uso más avanzado. El
componente `Image` acepta las siguientes propiedades.

#### objectFit

Cómo debe redimensionarse una imagen cuando `layout="fill"`.

[Mas información](https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit).

#### objectPosition

Cómo debe posicionarse una imagen cuando `layout="fill"`.

[Mas información](https://developer.mozilla.org/en-US/docs/Web/CSS/object-position).

#### loading

<!-- prettier-ignore-start -->
:::caution
La siguiente propiedad está pensada para usos avanzados. Hacer que una
imagen carge con `eager` normalmente **perjudica el rendimiento**.

Recomendamos utilizar la propiedad `priority` en su lugar, la cual carga
la imagen _eagerly_ en casi todos los casos.
:::
<!-- prettier-ignore-end -->

El comportamiento de carga de la imagen. Por defecto, `lazy`.

Cuando es `lazy`, la imagen cargará cuando el usuario se acerque a la
misma haciendo _scroll_.

Cuando es `eager`, cargará la imagen inmediatamente.

[Más información](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-loading).

#### unoptimized

Cuando es `true`, la imagen original será servida como vino al mundo en
vez de alterar su calidad, dimensiones y/o formato. Por defecto es
`false`.

### Otras Propiedades {#other-props}

El resto de propiedades del componente `Image` serán pasadas al componente
`img` excepto las siguientes:

- `style`. Usa `className` en su lugar.
- `srcSet`. Usa [`deviceSizes`](#device-sizes) en su lugar.
- `decoding`. Siempre es `"async"`.
